/**
 * Visitor.js 0.1
 * (c) 2012 Jonas Hermsmeier
 * For details, see: https://github.com/jhermsmeier/visitor.js
 * Licensed under the MIT license.
 */
(function(e){var h=e.document,g=e.navigator,k=e.screen,m=e.localStorage,p=function(){var j=(new Date).getTime(),f={trackLocation:!0,locationData:"location",locationTimeout:6,useGoogleLocation:!0,useHTML5Location:!1,sessionData:"session",sessionTimeout:32,arrived:null},n={locale:function(){var a=(g.language||g.browserLanguage||g.systemLanguage||g.userLanguage).toLowerCase().split("-");return{country:a[1]||a[0],language:a[0]}},location:function(){if(f.trackLocation){var a=function(a,d){var c=l.retrieveData(f.locationData);
!c||"Google"!==c.source?(e.googleLocationReady=function(){if(e.google&&e.google.loader&&e.google.loader.ClientLocation){var c=e.google.loader.ClientLocation,c={latitude:c.latitude,longitude:c.longitude,accuracy:null,address:{city:c.address.city,region:c.address.region,country:c.address.country,countryCode:c.address.country_code},source:"Google"};a(c,d);l.storeData(f.locationData,c,36E5*f.locationTimeout)}else a(null,d)},l.loadScript("https://www.google.com/jsapi?callback=googleLocationReady")):a(c,
d)};if(f.useHTML5Location)return function(b,d){g.geolocation?g.geolocation.getCurrentPosition(function(a){b({latitude:a.coords.latitude,longitude:a.coords.longitude,accuracy:a.coords.accuracy,address:null,source:"Client"},d)},function(){a(b,d)}):a(b,d)};if(f.useGoogleLocation)return a}return null},timezone:function(){var a=new Date;a.setMonth(0);a.setDate(1);var b=new Date;b.setMonth(6);b.setDate(1);return{offset:(new Date).getTimezoneOffset()/-60,dst:a.getTimezoneOffset()!==b.getTimezoneOffset()}},
session:function(){var a=l.retrieveData(f.sessionData),b={url:l.parseUrl(h.referrer||h.URL),search:null},d=b.url.query||{},d=d.q||d.p||d.wd||null,c=b.url.host.split("."),c=c[c.length-2];d&&(b.search={engine:c?c[0].toUpperCase()+c.substr(1):null,terms:d.split(" ")});null===a?a={start:j,visits:1,lastVisit:j,referrer:b}:(a.lastVisit=j,a.referrer=b,a.visits++);l.storeData(f.sessionData,a,864E5*f.sessionTimeout);return a},browser:function(){var a=null,b,d,c={Chrome:"Chrome",OmniWeb:"OmniWeb",Safari:"Apple",
iCab:"iCab",Konqueror:"KDE",Firefox:"Firefox",Camino:"Camino","Internet Explorer":"MSIE",Mozilla:"Gecko",Opera:"Opera"};for(a in c)if(b=g.userAgent.match(RegExp("("+c[a]+")(?:(?:/| )([0-9._]*))?")),d=g.userAgent.match(/Version(?:\/| )([0-9._]*)/),b)break;b=d&&d[1]||b&&b[2]||null;var i;if(g.plugins){d=["flash","silverlight","java","quicktime"];var c={},e,f;for(i in d){f=d[i];c[f]=!1;for(var h in g.plugins)if(e=g.plugins[h],e.name&&-1!==e.name.toLowerCase().indexOf(f)){c[f]=!0;break}}i=c}else i=null;
return{name:a,version:b,plugins:i}},device:function(){var a,b,d,c,i;a={Microsoft:{"Windows 8":"Windows NT (6[.]2)","Windows 7":"Windows NT (6[.]1)","Windows Vista":"Windows NT (6[.]0)","Windows XP":"Windows NT (5[.](?:1|2))","Windows Phone":"Windows Phone OS","Windows Mobile":"Windows Mobile","Windows CE":"Windows CE"},Apple:{"Mac Power PC":"Mac PPC|PPC|Mac PowerPC|Mac_PowerPC","Mac OS X":"Mac OS X","Mac iOS":"iPod|iPad|iPhone",Mac:"Darwin|Macintosh|Power Macintosh|Mac OS"},Google:{Android:"Android"},
Canonical:{Kubuntu:"Kubuntu",Xubuntu:"Xubuntu",Edubuntu:"Edubuntu",Ubuntu:"Ubuntu"},Other:{Debian:"Debian",Fedora:"Fedora",CentOS:"CentOS|Cent OS","Linux Mint":"Linux Mint",openSUSE:"openSUSE",Linux:"Linux",Maemo:"Maemo",FreeBSD:"FreeBSD",NetBSD:"NetBSD",OpenBSD:"OpenBSD",Dragonfly:"Dragonfly",Syllable:"Syllable"},HP:{webOS:"webOS","Palm OS":"PalmOS|Palm OS"},RIM:{BlackBerry:"BlackBerry","RIM Tablet OS":"RIM Tablet OS",QNX:"QNX"},Accenture:{"Symbian OS":"SymbOS|SymbianOS|Symbian OS"},Samsung:{bada:"bada"},
Nintendo:{"Nintendo Wii":"Nintendo Wii","Nintendo DS":"Nintendo DS","Nintendo DSi":"Nintendo DSi"},Sony:{"Playstation Portable":"Playstation Portable",Playstation:"Playstation"},Oracle:{Solaris:"SunOS|Sun OS"}};for(b in a){for(d in a[b])if(c=g.userAgent.match(RegExp(a[b][d]+"(?:(?:/| )([0-9._]*))?","i"))){i=(i=c[2]||c[1]||null)?i.replace(/_/g,"."):null;break}if(c)break}a=h.documentElement;c=h.getElementsByTagName("body")[0];var f=!!g.userAgent.match(/(iPad|SCH-I800|xoom|kindle)/i),j=!!g.userAgent.match(/(iPhone|iPod|blackberry|android 0.5|htc|lg|midp|mmp|mobile|nokia|opera mini|palm|pocket|psp|sgh|smartphone|symbian|treo mini|Playstation Portable|SonyEricsson|Samsung|MobileExplorer|PalmSource|Benq|Windows Phone|Windows Mobile|IEMobile|Windows CE|Nintendo Wii)/i);
return{os:{vendor:b||null,name:d||null,version:i||null},screen:{width:k.width,height:k.height,pixelRatio:e.devicePixelRatio||null},viewport:{width:e.innerWidth||a.clientWidth||c.clientWidth||k.availWidth,height:e.innerHeight||a.clientHeight||c.clientHeight||k.availHeight,colorDepth:k.colorDepth||k.pixelDepth||null},isTablet:f,isPhone:!f&&j,isMobile:f||j}}},l={parseUrl:function(a){var b=h.createElement("a"),d={};b.href=a;a=b.search.substr(1);if(""!==a){var a=a.split("&"),c,e;for(e in a)c=a[e].split("="),
2===c.length&&(d[c[0]]=decodeURIComponent(c[1]))}else d=null;return{scheme:b.protocol.substr(0,b.protocol.length-1),host:b.host,port:""===b.port?80:b.port,path:b.pathname,query:d,fragment:b.hash||null}},setCookie:function(a,b,d,c,e,f){if(!h.cookie||!a)return!1;b||(d=-1);d&&(d=j+d);return h.cookie=[encodeURIComponent(a),"=",encodeURIComponent(""+b),d?"; expires="+(new Date(d)).toGMTString():"",c?"; path="+c:"",e?"; domain="+e:"",f?"; secure":""].join("")},getCookie:function(a,b){if(!h.cookie)return!1;
b=RegExp("(?:^|; )"+encodeURIComponent(a)+"=([^;]*)");return(b=b.exec(h.cookie))?decodeURIComponent(b[1]):null},storeData:function(a,b,d){m?m[a]=b?this.pack(b,d):void 0:this.setCookie(a,this.pack(b),d)},retrieveData:function(a){return m&&m[a]?this.unpack(m[a]):this.unpack(this.getCookie(a))},pack:function(a,b){a.VERSION=0.1;b&&(a.EXPIRES=j+b);var d=o.stringify(a);delete a.VERSION;delete a.EXPIRES;return d},unpack:function(a){return(a=o.parse(a))&&0.1===a.VERSION&&a.EXPIRES>j?(delete a.VERSION,delete a.EXPIRES,
a):null},loadScript:function(a,b){b=h.createElement("script");b.type="text/javascript";b.src=a;h.getElementsByTagName("head")[0].appendChild(b)}},o={parse:e.JSON&&e.JSON.parse||function(){return"string"!==typeof data||!data?null:(new Function("return "+data))()},stringify:e.JSON&&e.JSON.stringify||function(a){var b=typeof a;if("object"!==b||null===a){if("string"===b)return'"'+a+'"'}else{var d,c,e=[],f=a.constructor===Array;for(d in a)c=a[d],b=typeof c,"string"===b?c='"'+c+'"':"object"===b&&null!==
c&&(c=this.stringify(c)),e.push((f?"":'"'+d+'":')+c);return(f?"[":"{")+e.join()+(f?"]":"}")}}};return function(){var a,b,d=this,c=0,g=function(){0===c&&"function"===typeof f.arrived&&f.arrived(d)};if(e.visit&&"object"===typeof e.visit)for(a in e.visit)f[a]=e.visit[a];for(a in n)if(b=d[a]=n[a](),"function"===typeof b)try{b(function(a,b){d[b]=a;c--;g()},a),c++}catch(h){console.log(h.message)}g()}}();e.visitor=new p})(this);
